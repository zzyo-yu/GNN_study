# 代码流程

## 1. 处理数据

对用户-项目交互文件进行处理，得到用户-项目交互数据

## 2. 划分数据集

这一步利用交互数据生成了 `节点集（包括项目和用户）` 和 `边索引`

训练集使用 `TrainDataLoader`

验证集和测试集使用 `FullSortEvalDataLoader`

# 3. 获取模型

# 4. 获取训练器

使用 `Trainer` 训练器

# 5. 训练

分为训练和验证

`训练阶段`进行前向计算，得到用户嵌入和对应的正/反例嵌入，然后进行预测得分计算，最后计算对应的损失（BPR损失和正则化损失），进行反向传播。

`验证阶段`进行全排序评估，对所有用户计算与所有项的得分，然后去掉不在对应数据集（train/test/eval）中的得分，再找出top n项，与用户的正向交互列表进行计算（相应的评估指标）。

